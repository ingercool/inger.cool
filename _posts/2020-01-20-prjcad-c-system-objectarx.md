---
title: "基于ObjectArx的AutoCAD二次开发：锚杆支护系统的设计及自动绘图软件"
layout: post
date: 2020-01-20
tag:
- c++
- ObjectARX
category: projects
projects: true
author: ingerchao
---

### 开发工具及版本说明

- OS：Windows 10
- Visual Studio 2015
- ObjectArx 2017 
- AutoCAD 2017
- C++ 11

### 需求说明

锚杆支护是指在边坡、岩土深基坑等地表工程及隧道、采场等地下硐室施工中采用的一种加固支护方式。AutoCAD 是 Autodesk 公司首次于 1982 年开发的自动计算机辅助设计软件，用于二维绘图、详细绘制、设计文档和基本三维设计，现已经成为国际上广为流行的绘图工具。要求设计一个软件，实现根据不同的计算方法对矿井巷道参数进行设计，并调用 AutoCAD 绘制巷道锚杆锚索支护设计图。

该锚杆支护系统需要具备以下几个功能模块：

1. 工程管理模块：完成工程的新建、打开和保存功能。每个子功能应具有

良好的用户交互设计；

2. 巷道参数管理模块：完成对巷道参数的输入及数据验证功能；

3. 计算方法模块：根据不同的计算方法，输入相应的参数进行计算；

4. 自动绘图模块：根据巷道参数、锚杆、锚索参数绘制不同的 AutoCAD 设

计图。

### 架构设计

对软件的功能需求进行分析，设计本系统的架构为以下三种子模块：

1. 负责与用户交互、处理数据的可执行文件 MFCad.exe;
2. 负责绘图的 AutoCAD加载文件 INGprjcadc.arx；
3. 桥接文件 brideg.ini，负责将以上两程序的数据进行桥接，完成参数的传递。



### 具体实现

- 基于**单例模式**的 Project 实例对象；
- 基于建造者模式的 ProjectBuilder 类实现对本系统中一个工程的参数的构建和保存等功能，利用**建造者模式**创建工程类这一复杂对象，工程类包括基本的巷道属性、支护方式、计算方法及各锚杆锚索参数等。
- 将不同的计算方法采用**工厂模式**进行封装，在 BuildMethod 方法中对工程的各个计算方法进行初始化，采用静态转型方法进行向下转型，便于工程中抽象得调用。
- 基于 ObjectArx 提供的 api 进行调用并封装接口，根据不同巷道的绘制中调用。



[系统实现报告（内含运行截图）](./../assets/pdf/report-maogan-system.pdf)

